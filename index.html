<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºŒç­‰ç„¡äººèˆªç©ºæ©Ÿæ“ç¸¦å£« å­¦ç§‘è©¦é¨“ æ¨¡æ“¬è©¦é¨“</title>
    <meta name="description" content="äºŒç­‰ç„¡äººèˆªç©ºæ©Ÿæ“ç¸¦å£«ã®å­¦ç§‘è©¦é¨“å¯¾ç­–å‘ã‘æ¨¡æ“¬å•é¡Œï¼ˆå…¨4ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‚’é‡è¤‡ãªã—ã§ãƒ©ãƒ³ãƒ€ãƒ ã«é–‹å§‹ã—ã¾ã™ã€‚">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            padding: 20px;
            max-width: 960px;
            margin: 0 auto;
            color: #333;
            background-color: #f0f0f5;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        h1 {
            color: #00796b;
            font-size: 2em;
            margin-bottom: 50px; /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é™¤å»ã«ã‚ˆã‚Šãƒãƒ¼ã‚¸ãƒ³ã‚’èª¿æ•´ */
        }
        /* pã‚¿ã‚°ãŒé™¤å»ã•ã‚ŒãŸãŸã‚ã€ã“ã“ã§ã¯ä¸è¦ */
        
        .exam-info {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 50px; /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é™¤å»ã«ã‚ˆã‚Šãƒãƒ¼ã‚¸ãƒ³ã‚’èª¿æ•´ */
            width: 100%;
            max-width: 450px;
            text-align: left;
        }
        .exam-info h2 {
            color: #004d40;
            border-bottom: 2px solid #e0f2f1;
            padding-bottom: 10px;
            margin-top: 0;
            font-size: 1.3em;
        }
        .exam-info ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .exam-info li {
            font-size: 1.05em;
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
        }
        .exam-info li:last-child {
            border-bottom: none;
        }
        .exam-info strong {
            display: inline-block;
            width: 110px;
            color: #004d40;
            font-weight: bold;
            text-align: right;
            padding-right: 10px;
        }
        /* START BUTTON STYLE */
        .start-button {
            padding: 15px 30px;
            font-size: 1.5em;
            color: #fff;
            background-color: #009688;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }
        .start-button:hover {
            background-color: #00796b;
        }
        .start-button:active {
            transform: scale(0.98);
        }

        /* ä»¥å‰ã® #quizStatus é–¢é€£ã®CSSã¯é™¤å»ã—ã¾ã—ãŸ */
    </style>
</head>
<body>
    <h1>äºŒç­‰ç„¡äººèˆªç©ºæ©Ÿæ“ç¸¦å£« å­¦ç§‘è©¦é¨“å¯¾ç­–</h1>
    <div class="exam-info">
        <h2>ğŸ’¡ å­¦ç§‘è©¦é¨“ã®æ¦‚è¦ï¼ˆäºŒç­‰ï¼‰</h2>
        <ul>
            <li><strong>è©¦é¨“æ™‚é–“</strong>ï¼š30åˆ†</li>
            <li><strong>å•é¡Œæ•°</strong>ï¼š50å•</li>
            <li><strong>å½¢å¼</strong>ï¼šæŠä¸€å¼</li>
            <li><strong>åˆæ ¼åŸºæº–</strong>ï¼š80ï¼… (40å•) ã‚’ä»®å®š</li>
        </ul>
    </div>

    <button id="startButton" class="start-button">æ¨¡æ“¬è©¦é¨“ã‚’é–‹å§‹ã™ã‚‹</button>

    <script>
        /**
         * æ¨¡æ“¬è©¦é¨“ã®é‡è¤‡ãªã—ã‚µã‚¤ã‚¯ãƒ«ã‚’ç®¡ç†ã™ã‚‹JavaScript
         * - localStorageã‚’ä½¿ç”¨ã—ã¦ã€ç¾åœ¨ã®ã‚µã‚¤ã‚¯ãƒ«ã§æ®‹ã£ã¦ã„ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜æ†¶ã—ã¾ã™ã€‚
         * - ç”»é¢ä¸Šã®é€²æ—è¡¨ç¤ºã¯è¡Œã„ã¾ã›ã‚“ãŒã€é‡è¤‡ãªã—ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯ç¶™ç¶šã—ã¾ã™ã€‚
         */

        const allQuizzes = [
            'quiz_1.html',
            'quiz_2.html',
            'quiz_3.html',
            'quiz_4.html'
        ];
        const storageKey = 'availableQuizzes'; // localStorageã®ã‚­ãƒ¼
        const startButton = document.getElementById('startButton');
        // const statusElement = document.getElementById('quizStatus'); // é™¤å»

        /**
         * é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã™ã‚‹ï¼ˆFisher-Yatesã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                // è¦ç´ ã‚’äº¤æ›
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * localStorageã‹ã‚‰åˆ©ç”¨å¯èƒ½ãªã‚¯ã‚¤ã‚ºã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹ã€‚
         * ãƒªã‚¹ãƒˆãŒãªã„ã€ã¾ãŸã¯ç©ºã®å ´åˆã¯ã€æ–°ã—ã„ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚ŒãŸãƒªã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚
         * @returns {Array<string>} åˆ©ç”¨å¯èƒ½ãªã‚¯ã‚¤ã‚ºã®ãƒ•ã‚¡ã‚¤ãƒ«åãƒªã‚¹ãƒˆ
         */
        function getAvailableQuizzes() {
            const stored = localStorage.getItem(storageKey);
            if (stored) {
                try {
                    let available = JSON.parse(stored);
                    // æ ¼ç´ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒæœ‰åŠ¹ã§ã€ã‹ã¤ç©ºã§ãªã„ã“ã¨ã‚’ç¢ºèª
                    if (Array.isArray(available) && available.length > 0 && available.every(q => allQuizzes.includes(q))) {
                        return available;
                    }
                } catch (e) {
                    console.error("Error parsing localStorage:", e);
                    // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã‚‚æ–°ã—ã„ã‚µã‚¤ã‚¯ãƒ«ã‚’é–‹å§‹
                }
            }
            // ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã€ç„¡åŠ¹ã€ã¾ãŸã¯ã‚µã‚¤ã‚¯ãƒ«ãŒå®Œäº†ã—ãŸå ´åˆã¯ã€æ–°ã—ã„ã‚µã‚¤ã‚¯ãƒ«ã‚’é–‹å§‹ã™ã‚‹ï¼ˆã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼‰
            return shuffleArray([...allQuizzes]);
        }

        /**
         * ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°ï¼ˆãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œï¼‰
         */
        function startQuiz() {
            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã¦äºŒé‡ã‚¯ãƒªãƒƒã‚¯ã‚’é˜²ã
            startButton.disabled = true;
            startButton.textContent = 'é–‹å§‹ä¸­...';

            let availableQuizzes = getAvailableQuizzes();

            // 1. åˆ©ç”¨å¯èƒ½ãªã‚¯ã‚¤ã‚ºã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«1ã¤ã‚’é¸æŠ
            const quizIndex = Math.floor(Math.random() * availableQuizzes.length);
            const selectedQuiz = availableQuizzes[quizIndex];

            // 2. é¸æŠã—ãŸã‚¯ã‚¤ã‚ºã‚’ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤ï¼ˆé‡è¤‡é˜²æ­¢ï¼‰
            availableQuizzes.splice(quizIndex, 1);

            // 3. æ›´æ–°ã•ã‚ŒãŸãƒªã‚¹ãƒˆã‚’localStorageã«ä¿å­˜
            if (availableQuizzes.length === 0) {
                // ã‚µã‚¤ã‚¯ãƒ«å®Œäº†ï¼šlocalStorageã‚’ã‚¯ãƒªã‚¢ã—ã€æ¬¡å›ã®ã‚¹ã‚¿ãƒ¼ãƒˆã§å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
                localStorage.removeItem(storageKey);
                console.log("ã‚µã‚¤ã‚¯ãƒ«å®Œäº†ã€‚localStorageã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚");
            } else {
                // ã‚µã‚¤ã‚¯ãƒ«ç¶™ç¶šä¸­
                localStorage.setItem(storageKey, JSON.stringify(availableQuizzes));
                console.log("æ®‹ã‚Šã®ã‚¯ã‚¤ã‚º:", availableQuizzes);
            }

            // 4. é¸æŠã•ã‚ŒãŸã‚¯ã‚¤ã‚ºãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
            window.location.href = selectedQuiz;
        }
        
        // ä¿®æ­£ç‚¹2: updateStatusDisplay é–¢æ•°ã‚’é™¤å»
        
        // åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
        document.addEventListener('DOMContentLoaded', () => {
            // updateStatusDisplay() ã®å‘¼ã³å‡ºã—ã‚’é™¤å»
            startButton.addEventListener('click', startQuiz);
            
            // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã€ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’åˆæœŸåŒ–ï¼ˆå¿µã®ãŸã‚ï¼‰
            startButton.textContent = 'æ¨¡æ“¬è©¦é¨“ã‚’é–‹å§‹ã™ã‚‹';
            startButton.disabled = false;
        });
    </script>
</body>
</html>